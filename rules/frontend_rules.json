[
  {
    "id": "NFR-FE-001",
    "title": "fetch call without AbortSignal",
    "category": "reliability",
    "top_level_category": "front_end",
    "sub_category": "concurrency",
    "severity": "S3",
    "pattern": "\\bfetch\\s*\\(\\s*[^,\\n\\)]*(?:,\\s*\\{(?![^}]*\\bsignal\\b)[^}]*\\})?\\s*\\)(?![\\s\\S]{0,120}\\b(useQuery|useSWR|swr|axiosInstance)\\b)",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.js",
      "*.jsx",
      "*.ts",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "AbortSignal is recommended for fetches that can outlive a component. Wrapper-based data layers may handle cancellation differently; treat as review.",
    "confidence_hint": 0.5,
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-002",
    "title": "Axios call without timeout",
    "category": "reliability",
    "top_level_category": "front_end",
    "sub_category": "loading",
    "severity": "S2",
    "pattern": "\\baxios\\.(get|post|put|delete|request)\\s*\\((?![^\\)]*\\btimeout\\b)(?![^\\)]*\\baxiosInstance\\b)[^\\)]*\\)",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.js",
      "*.jsx",
      "*.ts",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Client calls without timeout can hang and consume resources during upstream degradation.",
    "confidence_hint": 0.6,
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-003",
    "title": "setInterval without cleanup",
    "category": "reliability",
    "top_level_category": "front_end",
    "sub_category": "concurrency",
    "severity": "S2",
    "pattern": "\\buseEffect\\s*\\(\\s*\\(\\s*=>[\\s\\S]{0,600}\\bsetInterval\\s*\\((?![\\s\\S]{0,600}\\bclearInterval\\s*\\()",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.js",
      "*.jsx",
      "*.ts",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Intervals that survive component teardown cause memory leaks and repeated background execution.",
    "confidence_hint": 0.6,
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-004",
    "title": "Unhandled promise chain",
    "category": "reliability",
    "top_level_category": "front_end",
    "sub_category": "concurrency",
    "severity": "S2",
    "pattern": "\\.then\\s*\\(\\s*[^,\\)]{1,240}\\s*\\)(?!\\s*,)(?![\\s\\S]{0,120}\\.catch\\s*\\()(?![\\s\\S]{0,120}\\.finally\\s*\\()",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.js",
      "*.jsx",
      "*.ts",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Unhandled async errors frequently degrade UX and mask production incidents.",
    "confidence_hint": 0.55,
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-005A",
    "title": "Risky innerHTML/dangerouslySetInnerHTML from dynamic source",
    "category": "reliability",
    "top_level_category": "front_end",
    "sub_category": "loading",
    "severity": "S1",
    "confidence_hint": 0.9,
    "pattern": "(dangerouslySetInnerHTML\\s*=\\s*\\{\\s*\\{\\s*__html\\s*:\\s*(?![\"\\'`])[\\s\\S]{1,220}\\}\\s*\\}|\\b[A-Za-z_$][A-Za-z0-9_$]*\\.innerHTML\\s*=\\s*(?!\\s*[\"\\'`])[^;\\n]{1,220})",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.js",
      "*.jsx",
      "*.ts",
      "*.tsx",
      "*.vue",
      "*.html"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Dynamic content assigned to raw HTML sinks is high-risk (XSS/injection). Sanitize or use safe rendering APIs.",
    "enforcement_level": "hard_fail"
  },
  {
    "id": "NFR-FE-005B",
    "title": "innerHTML/dangerouslySetInnerHTML with static literal (review)",
    "category": "reliability",
    "top_level_category": "front_end",
    "sub_category": "loading",
    "severity": "S3",
    "confidence_hint": 0.6,
    "pattern": "(dangerouslySetInnerHTML\\s*=\\s*\\{\\s*\\{\\s*__html\\s*:\\s*[\"\\'`][\\s\\S]{0,220}[\"\\'`]\\s*\\}\\s*\\}|\\b[A-Za-z_$][A-Za-z0-9_$]*\\.innerHTML\\s*=\\s*[\"\\'`][^;\\n]{0,220}[\"\\'`])",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.js",
      "*.jsx",
      "*.ts",
      "*.tsx",
      "*.vue",
      "*.html"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Raw HTML assignment with literals may be acceptable but should be reviewed for trust boundaries and maintainability.",
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-006",
    "title": "Array index used as React key",
    "category": "performance",
    "top_level_category": "front_end",
    "sub_category": "performance",
    "severity": "S3",
    "pattern": "\\bkey\\s*=\\s*\\{\\s*(index|i)\\s*\\}",
    "include_globs": [
      "*.jsx",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Unstable keys increase rerenders and can corrupt UI state mapping.",
    "confidence_hint": 0.85,
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-007",
    "title": "Potential heavy mapping in render path (review)",
    "category": "performance",
    "top_level_category": "front_end",
    "sub_category": "performance",
    "severity": "S3",
    "pattern": "\\breturn\\s*\\([\\s\\S]{0,520}\\b[A-Za-z_][A-Za-z0-9_]*\\s*\\.\\s*map\\s*\\(",
    "include_globs": [
      "*.jsx",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Mapping in render can be fine for small lists; review for large datasets and consider memoization/virtualization.",
    "confidence_hint": 0.25,
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-008",
    "title": "No lazy loading for route components",
    "category": "performance",
    "top_level_category": "front_end",
    "sub_category": "loading",
    "severity": "S3",
    "pattern": "\\b(createBrowserRouter|createRoutesFromElements|Route)\\b[\\s\\S]{0,360}\\belement\\s*:\\s*<\\s*[A-Z][A-Za-z0-9_]*\\b(?![\\s\\S]{0,120}\\blazy\\s*\\(|\\bSuspense\\b|\\bimport\\s*\\()",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.js",
      "*.jsx",
      "*.ts",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Eager route loading inflates initial bundle and slows first contentful render.",
    "confidence_hint": 0.45,
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-009",
    "title": "Image without lazy loading",
    "category": "performance",
    "top_level_category": "front_end",
    "sub_category": "loading",
    "severity": "S3",
    "pattern": "<img\\b(?![^>]*\\bloading=\\\"lazy\\\")(?![^>]*\\bfetchpriority=\\\"high\\\")",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.html",
      "*.jsx",
      "*.tsx",
      "*.vue"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Non-lazy images increase network contention and render blocking under limited bandwidth.",
    "confidence_hint": 0.75,
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-010",
    "title": "Frequent input handler without debounce/throttle",
    "category": "performance",
    "top_level_category": "front_end",
    "sub_category": "loading",
    "severity": "S3",
    "pattern": "\\bon(Change|Input|KeyUp)\\s*=\\s*\\{(?![^\\}]{0,200}\\b(debounce|throttle)\\b)[^\\}]{0,220}(fetch|axios|dispatch|setState)",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.jsx",
      "*.tsx",
      "*.vue"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "High-frequency handlers without shaping can overload API and client runtime.",
    "confidence_hint": 0.5,
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-011",
    "title": "console.log in app code",
    "category": "reliability",
    "top_level_category": "front_end",
    "sub_category": "performance",
    "severity": "S4",
    "pattern": "\\bconsole\\.(log|debug|info|trace)\\s*\\(",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.js",
      "*.jsx",
      "*.ts",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*test*.*",
      "**/*spec*.*",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Excessive client logging increases noise and can affect render performance in low-end devices.",
    "confidence_hint": 0.95,
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-012",
    "title": "Blocking synchronous Web Storage access in loop",
    "category": "performance",
    "top_level_category": "front_end",
    "sub_category": "performance",
    "severity": "S4",
    "pattern": "\\b(for\\s*\\(|while\\s*\\()[\\s\\S]{0,220}\\b(localStorage|sessionStorage)\\.(getItem|setItem)\\s*\\(",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.js",
      "*.jsx",
      "*.ts",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Potential sync storage hotspot; often low-impact and context-dependent. Treat as low-priority warning.",
    "confidence_hint": 0.25,
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-013",
    "title": "Unbounded list rendering without virtualization",
    "category": "performance",
    "top_level_category": "front_end",
    "sub_category": "loading",
    "severity": "S3",
    "confidence_hint": 0.35,
    "pattern": "\\breturn\\b[\\s\\S]{0,420}\\b(items|rows|results|records|data)\\b\\s*\\.map\\s*\\((?![\\s\\S]{0,220}\\b(VirtualizedList|react-window|react-virtualized|Virtualize)\\b)",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.jsx",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Large list rendering may need virtualization. Heuristic triggers on common large-collection identifiers; treat as review.",
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-014",
    "title": "useEffect data fetch missing dependency array",
    "category": "reliability",
    "top_level_category": "front_end",
    "sub_category": "concurrency",
    "severity": "S3",
    "confidence_hint": 0.55,
    "pattern": "\\buseEffect\\s*\\(\\s*\\(\\s*\\)\\s*=>[\\s\\S]{0,320}\\b(fetch|axios\\.(get|post|put|delete|request))\\b[\\s\\S]{0,320}\\)\\s*(?!,\\s*\\[)(?![\\s\\S]{0,120}eslint-disable-next-line\\s+react-hooks/exhaustive-deps)",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.js",
      "*.jsx",
      "*.ts",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Effects that fetch data without a dependency array can re-run unexpectedly. Treat as review; allow explicit lint suppression where justified.",
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-015",
    "title": "addEventListener in effect without cleanup",
    "category": "reliability",
    "top_level_category": "front_end",
    "sub_category": "concurrency",
    "severity": "S2",
    "confidence_hint": 0.6,
    "pattern": "\\buseEffect\\s*\\(\\s*\\(\\s*\\)\\s*=>[\\s\\S]{0,320}\\baddEventListener\\s*\\([\\s\\S]{0,320}(?!return\\s*\\(\\s*\\)\\s*=>[\\s\\S]{0,220}\\bremoveEventListener\\s*\\()",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.js",
      "*.jsx",
      "*.ts",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Event listeners created in effects should be removed on cleanup to avoid leaks and duplicated handlers.",
    "enforcement_level": "review"
  },
  {
    "id": "NFR-FE-016",
    "title": "Large bundle import anti-patterns",
    "category": "performance",
    "top_level_category": "front_end",
    "sub_category": "loading",
    "severity": "S3",
    "confidence_hint": 0.75,
    "pattern": "\\b(import\\s+[\\*]\\s+as\\s+[A-Za-z0-9_]+\\s+from\\s+[\"'][^\"']+[\"']|import\\s+[\"']moment/locale/all[\"']|require\\s*\\(\\s*[\"']moment/locale/all[\"']\\s*\\))",
    "ignore_comment_lines": true,
    "include_globs": [
      "*.js",
      "*.jsx",
      "*.ts",
      "*.tsx"
    ],
    "exclude_globs": [
      "**/node_modules/**",
      "**/dist/**",
      "**/build/**",
      "**/.next/**",
      "**/coverage/**",
      "**/*.min.js",
      "**/vendor/**",
      "**/lib/**",
      "**/wwwroot/lib/**",
      "**/Scripts/ej2/**",
      "**/jquery*/**"
    ],
    "rationale": "Broad/wildcard imports and moment locale-all import can inflate bundle size and hurt load performance.",
    "enforcement_level": "review"
  }
]