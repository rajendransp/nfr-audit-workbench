[
  {
    "name": "fe_014_detects_useeffect_fetch_without_dependency_array",
    "rule_id": "NFR-FE-014",
    "file": "component.tsx",
    "content": "import { useEffect } from 'react';\nexport function C(){ useEffect(() => { fetch('/api/items'); }); return null; }\n",
    "expected_match_lines": [2]
  },
  {
    "name": "fe_014_skips_when_dependency_array_present",
    "rule_id": "NFR-FE-014",
    "file": "component2.tsx",
    "content": "import { useEffect } from 'react';\nexport function C(){ useEffect(() => { fetch('/api/items'); }, []); return null; }\n",
    "expected_match_lines": []
  },
  {
    "name": "fe_005a_detects_risky_innerhtml_source",
    "rule_id": "NFR-FE-005A",
    "file": "xss.js",
    "content": "function p(editor){ preview.innerHTML = marked(editor.value); }\n",
    "expected_match_lines": [1]
  },
  {
    "name": "fe_005a_skips_constant_innerhtml",
    "rule_id": "NFR-FE-005A",
    "file": "safe.js",
    "content": "function p(){ preview.innerHTML = '<b>ok</b>'; }\n",
    "expected_match_lines": []
  },
  {
    "name": "fe_005b_detects_generic_innerhtml",
    "rule_id": "NFR-FE-005B",
    "file": "generic.js",
    "content": "function p(v){ node.innerHTML = v; }\n",
    "expected_match_lines": [1]
  },
  {
    "name": "fe_015_detects_addEventListener_without_cleanup",
    "rule_id": "NFR-FE-015",
    "file": "listener.tsx",
    "content": "import { useEffect } from 'react';\nexport function L(){ useEffect(() => { window.addEventListener('resize', onResize); }, []); return null; }\n",
    "expected_match_lines": [2]
  },
  {
    "name": "razor_004_detects_risky_markupstring_source",
    "rule_id": "NFR-RAZOR-004",
    "file": "Comp.razor",
    "content": "@code { MarkupString Body => new MarkupString(response.Content); }\n",
    "expected_match_lines": [1]
  },
  {
    "name": "razor_004b_detects_generic_markupstring_usage",
    "rule_id": "NFR-RAZOR-004B",
    "file": "Comp2.razor",
    "content": "@code { MarkupString Body => new MarkupString(html); }\n",
    "expected_match_lines": [1]
  },
  {
    "name": "api_016_detects_missing_ct_propagation",
    "rule_id": "NFR-API-016",
    "file": "Controller.cs",
    "content": "using System.Threading;\nusing System.Threading.Tasks;\npublic class C { public async Task<IActionResult> Post(CancellationToken ct){ await service.SaveAsync(model); return Ok(); } }\n",
    "expected_match_lines": [3]
  },
  {
    "name": "api_016_skips_when_ct_propagated",
    "rule_id": "NFR-API-016",
    "file": "Controller2.cs",
    "content": "using System.Threading;\nusing System.Threading.Tasks;\npublic class C { public async Task<IActionResult> Post(CancellationToken ct){ await service.SaveAsync(model, ct); return Ok(); } }\n",
    "expected_match_lines": []
  }
]
